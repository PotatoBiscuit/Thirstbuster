package com.CS477.drinkandgo.activities;

import android.content.SharedPreferences.Editor;
import android.view.View;
import android.widget.TextView;
import android.widget.Toast;

import com.CS477.drinkandgo.Customer;
import com.CS477.drinkandgo.R;
import com.CS477.drinkandgo.requests.SignUpRequest;
import com.android.volley.Response.Listener;
import com.android.volley.toolbox.Volley;


public class SignUpActivity extends DrinkAndGoActivity 
{
	public SignUpActivity()
	{	super(R.layout.activity_sign_up, MainActivity.class);}
	
	public void performSignUp(View view)
	{
		TextView name = get(R.id.name_view),
				username = get(R.id.username_view),
				cardNum = get(R.id.card_number_view),
				password = get(R.id.password_view),
				password2 = get(R.id.password_view2);
		
		if(username.getText().toString().isEmpty()
		|| cardNum.getText().toString().isEmpty() || password.getText().toString().isEmpty()
		|| password2.getText().toString().isEmpty() || name.getText().toString().isEmpty())
		{
			Toast.makeText(this, getString(R.string.input_error), 
			Toast.LENGTH_SHORT).show();
		}
		else if(!password.getText().toString().equals(password2.getText().toString()))
		{
			Toast.makeText(this, getString(R.string.password_error), 
								Toast.LENGTH_SHORT).show();
			password.setText("");
			password2.setText("");
		}
		else if(uniqueUsername(username.getText().toString()))
		{
			Volley.newRequestQueue(this).add(new SignUpRequest(this,
					new Customer(), ));
		}
		else 
		{
			Toast.makeText(this, getString(R.string.username_not_unique), 
			Toast.LENGTH_SHORT).show();
			username.setText("");
		}
	}
	
	private TextView get(int contentID)
	{	return (TextView) findViewById(contentID);}
	
	private class SignUpListener implements Listener<String>
	{
		@Override
		public void onResponse(String response) 
		{
			Editor editor = getEditor();
			
			editor.apply();
			startActivity(VenueSearchActivity.class);
		}
	}
}
